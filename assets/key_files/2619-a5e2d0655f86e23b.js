"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2619],{12867:function(t,i,e){e.d(i,{ZB:function(){return h},co:function(){return T},rM:function(){return m}});var n,s,r,o,u,l,a,c,d,E,v,h,_=e(85389),p=e(23845);let m={PAGE_VIEW:"page_view",MAPS_PAGE_VIEW:"maps_page_view",BUTTON_EVENT:"button_interactions",PAYWALL_EVENT:"signup_modal",PURCHASE_EVENT:"purchase",REGISTER_EVENT:"sign_up",LOGIN_EVENT:"login",LOGOUT_EVENT:"logout",NEWSLETTER_EVENT:"sign_up_newsletter",ACCOUNT_SETTINGS_EVENT:"change_acount_settings",SOCIAL_SHARE_EVENT:"social_share",DAMAGES_EVENT:"damages_interactions",SEARCH_EVENT:"search",SELECT_ITEM_EVENT:"select_item",SEARCH_VIEWED_EVENT:"view_search_results",VIDEO_EVENT:"video",MODAL_OPEN:"modal_open",MODAL_CLOSE:"modal_close",MODAL_EVENT:{OPEN:"modal_open",CLOSE:"modal_close"},ERROR_EVENT:"errors",MAP_EVENT:"map_interaction",BUILDING_DETAILS_EVENT:"change_building_details",BEGIN_CHECKOUT_EVENT:"begin_checkout",VIEW_ITEM_EVENT:"view_item",LINK_EVENT:"link_interactions",SURVEY_EVENT:"survey",FLOOD_DAMAGES_EVENT:"has_flood_damages",FIRE_DAMAGES_EVENT:"has_fire_damages",HEAT_DAMAGES_EVENT:"has_heat_damages",KEY_INSIGHT_EVENT:"key_insights",FORM_START_EVENT:"form_start",FORM_SUBMIT_EVENT:"form_submit",SIGN_IN_MODAL_EVENT:"modal_flow_view",INTERACTION_EVENT:"interaction"};(n=a||(a={})).HOME="home",n.OVERVIEW="overview",n.INTERACTION_MAP="interactive map",n.DAMAGE="damage",n.REPORT="report",n.SOLUTIONS="solutions",n.METHODOLOGY="methodology",n.ENVIRONMENTAL="environmental",n.ABOUT="about",n.BILLING="billing",n.SETTINGS="settings",n.MY_PROPERTIES="my properties",n.REGISTER="register",n.FORGOT_PASSWORD="forgot password",n.LOGIN="login",n.PRICING="pricing",n.UNLOCK_PAGE="unlock",n.TEST_PAGE="test",(s=c||(c={})).CITY="city",s.ZIP="zip",s.STATE="state",s.NEIGHBORHOOD="neighborhood",s.COUNTY="county",s.RESIDENTIAL="residential",s.COMMERCIAL="commercial",s.SECONDARY="secondary",s.ACCOUNT="account",s.HOME="home",(r=d||(d={})).LOCKED="locked",r.UNLOCKED="unlocked",r.UNKNOWN="N/A",(o=E||(E={})).FLOOD="flood",o.FIRE="fire",o.HEAT="heat",o.WIND="wind",o.UNKNOWN="N/A",(u=v||(v={})).MODAL_EMAIL_STEP="01_email",u.MODAL_DETAILS_STEP="02_details",u.MODAL_LOGIN_STEP="02_login",u.MODAL_EXPERIENCE_STEP="03_customize_experience",(l=h||(h={})).FORM_ERROR="form error",l.DUPLICATE="duplicate",l.NO_DATA="no data",l.UNKNOWN="unknown",l.SERVER_ERROR="server error";class N{reset(){this.dl.push(function(){"function"==typeof this.reset&&this.reset()})}dataLayer(t){this.dl.push(...t)}track(t,i){"page_view"===t&&this.reset(),t===m.BEGIN_CHECKOUT_EVENT&&(this.ecommerce=null==i?void 0:i.ecommerce),(0,p.sendGTMEvent)({event:t,...i})}trackOnce(t,i,e){this.pt.find(i=>i===t)||(this.pt.push(t),this.track(i,e))}removeCachedToken(t){let i=this.pt.indexOf(t);-1!==i&&this.pt.splice(i,1)}identify(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dl.push({user_id:t,...i})}page(t){this.dl.push({...t})}trackError(t,i,e){this.track(m.ERROR_EVENT,{error_category:t,error_type:i,error_message:e})}formStart(t,i,e){return new g(this,t,i,e)}constructor(){(0,_._)(this,"dl",[]),(0,_._)(this,"pt",[]),(0,_._)(this,"ecommerce",void 0),this.dl=window.dataLayer||[],this.ecommerce=null}}class g{track(){this.a.track(m.FORM_START_EVENT,{form_id:this.id,form_name:this.name,form_destination:this.destination})}submitted(t){this.a.track(m.FORM_SUBMIT_EVENT,{form_id:this.id,form_name:this.name,form_destination:this.destination,form_submit_text:t})}constructor(t,i,e,n){(0,_._)(this,"a",void 0),(0,_._)(this,"id",void 0),(0,_._)(this,"name",void 0),(0,_._)(this,"destination",void 0),this.id=i,this.name=e,this.a=t,this.destination=n}}let T=new N},93615:function(t,i,e){e.d(i,{f:function(){return n}});function n(t){return t?t/100:-1}},65730:function(t,i,e){e.d(i,{cu:function(){return l},gC:function(){return a},jx:function(){return u}});var n=e(22694),s=e(85397),r=e(7775);let o="".concat("https://riskfactor.com/","api/mothership");async function u(t,i,e){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=new r.g6(o,{next:{revalidate:n},...e});try{return await s.request(t,i)}catch(t){throw JSON.stringify(null==t?void 0:t.response,void 0,2)}}function l(t,i,e){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,n.a)(["mothership",t],()=>u(i,e),s)}function a(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,s.D)(i=>u(t,{input:i},e),{onMutate:t=>t,...i})}},11448:function(t,i,e){e.d(i,{Z:function(){return u}});var n=e(22694),s=e(24033),r=e(79791);async function o(){let t=await fetch("/api/auth/session"),i=await t.json();return Object.keys(i).length?i:null}function u(){var t;let{required:i,redirectTo:e="/login?error=SessionExpired",queryConfig:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,s.useRouter)(),a=(0,n.a)(["mothership","session"],o,{onSettled(t){!t&&i&&l.push(e)},select:t=>new r.Z(t),...u});return{user:a.data,sessionStatus:"loading"===a.status?"loading":(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.session)?"auth":"nope",query:a}}},79791:function(t,i,e){e.d(i,{Z:function(){return l}});var n=e(85389),s=e(75867),r=e(93615);class o{get activeSubscription(){if(!this.subscriptions)return null;if(this.subscriptions){var t;let i=null===(t=this.subscriptions)||void 0===t?void 0:t.find(t=>(null==t?void 0:t.status)==="active"||(null==t?void 0:t.status)==="trialing");if(i)return i}return null}get subscriptionStatus(){if(this.activeSubscription){if("trialing"===this.activeSubscription.status)return"trialing";let t=new Date,i=this.subscriptionEndDate,e=this.subscriptionNextBillDate;if(i){if(!e||i<e)return"cancelling";if(i>=e||i>t)return"canceled"}return"active"}return null}get canUpgrade(){return!!((this.isTrialing||this.subscriptionStatus)&&["active","cancelling","trialing"].includes(this.subscriptionStatus))}get subscriptionEndDate(){let t=this.activeSubscription;return t?t.endedOn&&new Date(t.endedOn):null}get subscriptionNextBillDate(){let t=this.activeSubscription;if(t){var i,e;return(null===(i=t.upcomingInvoice)||void 0===i?void 0:i.nextPaymentAttempt)&&new Date(null===(e=t.upcomingInvoice)||void 0===e?void 0:e.nextPaymentAttempt)}return null}get activeProductId(){let t=this.activeSubscription;if(t&&t.items&&Array.isArray(t.items)&&t.items.length>0){var i,e;return(null==t?void 0:null===(e=t.items[0])||void 0===e?void 0:null===(i=e.product)||void 0===i?void 0:i.productId)||null}return null}get activeSubscriptionMeta(){let t=this.activeSubscription;if(!t)return null;let i=t.items;if(i&&i.length>0){var e,n,o,u,l,a,c,d,E;let v=i[0],h=null!==(n=t.discount)&&void 0!==n&&null!==(e=n.coupon)&&void 0!==e&&!!e.id,_=(null==v?void 0:null===(o=v.price)||void 0===o?void 0:o.amount)||-1,p=h?_-(null==t?void 0:null===(l=t.discount)||void 0===l?void 0:null===(u=l.coupon)||void 0===u?void 0:u.amountOff):_;return{productName:(null==v?void 0:null===(a=v.product)||void 0===a?void 0:a.productName)||"",productPrice:(0,s.x)((0,r.f)(p))||"",productPriceInterval:"YEAR"===(E=null==v?void 0:null===(c=v.price)||void 0===c?void 0:c.interval)?"Yearly":" MONTH"===E?"Monthly":null,isEnding:!!t.endedOn,isDiscounted:h,nextPaymentDate:new Date(t.endedOn?t.endedOn:null===(d=t.upcomingInvoice)||void 0===d?void 0:d.nextPaymentAttempt)}}return null}get subscriptionPricing(){if(!this.activeSubscription)return null}get isTrialing(){if(this.subscriptions){var t;if(null===(t=this.subscriptions)||void 0===t?void 0:t.find(t=>(null==t?void 0:t.status)==="trialing"))return!0}return!1}get isTrialEligible(){return!(this.subscriptions&&(this.isTrialing||this.subscriptions.find(t=>(null==t?void 0:t.status)==="canceled"||(null==t?void 0:t.status)==="active")))}get upcomingInvoiceAvailable(){let t=this.activeSubscription;return!!t&&!!t.upcomingInvoice}constructor(t){(0,n._)(this,"subscriptions",void 0),this.subscriptions=t}}class u{_reconstruct(t){var i,e,n;this.session=t,this.user=null===(i=this.session)||void 0===i?void 0:i.user;let s=(null===(e=this.user)||void 0===e?void 0:e.subscriptions)||[];this.subscription=new o(s),(null===(n=this.user)||void 0===n?void 0:n.session)&&delete this.user.session}refreshSession(t){this._reconstruct(t)}getFsfUserType(){var t,i;return(null===(t=this.user)||void 0===t?void 0:t.email)&&(null===(i=this.user)||void 0===i?void 0:i.email.indexOf("firststreet.org"))>-1?"first street":null}get stripeCustomerId(){var t;return(null===(t=this.user)||void 0===t?void 0:t.stripeCustomerId)?this.user.stripeCustomerId:null}get isValid(){return!!this.session&&!!this.user}toClient(){return this.session}get firstName(){var t;return(null===(t=this.user)||void 0===t?void 0:t.firstName)||""}get lastName(){var t;return(null===(t=this.user)||void 0===t?void 0:t.lastName)||""}get name(){return"".concat(this.firstName).concat(this.lastName?" ".concat(this.lastName):"")}get email(){var t;return null===(t=this.user)||void 0===t?void 0:t.email}get id(){var t;return null===(t=this.user)||void 0===t?void 0:t.id}get organization(){var t;return null===(t=this.user)||void 0===t?void 0:t.organization}get userId(){var t;return null===(t=this.user)||void 0===t?void 0:t.userId}get userGroup(){var t;return null===(t=this.user)||void 0===t?void 0:t.userGroup}get hasActiveUserGroup(){return null!==this&&void 0!==this&&!!this.userGroup&&this.userGroup.isActive}get userGroupName(){if(this.hasActiveUserGroup){var t;return(null===(t=this.userGroup)||void 0===t?void 0:t.groupName)||null}return null}get hasActiveSubscription(){var t;return null!==(t=this.subscription)&&void 0!==t&&!!t.activeSubscription}constructor(t){if((0,n._)(this,"session",void 0),(0,n._)(this,"user",void 0),(0,n._)(this,"subscription",void 0),!t)return this;this._reconstruct(t)}}var l=u},75867:function(t,i,e){e.d(i,{x:function(){return n}});function n(t){return t||0===t?t.toLocaleString("en-US",{maximumFractionDigits:2}).replace(/\B(?=(\d{3})+(?!\d))/g,","):null==t?void 0:t.toString()}}}]);